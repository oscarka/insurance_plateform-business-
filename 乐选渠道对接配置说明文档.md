# 乐选渠道对接配置说明文档

本文档基于《乐选渠道对接表.xlsx》分析，详细说明每一部分内容应该配置到哪里、设置到哪里，或者需要开发什么新功能。

---

## 一、功能需求（工作表1：功能需求）

### 1.1 核心功能清单

#### 已实现功能（需要完善）
1. **线上投保** - 投保接口
   - **配置位置**：`backend/routes/applications.js`
   - **前端页面**：`pages/NewPolicy.tsx`
   - **需要完善**：
     - 支付自定义格式化特约功能
     - 保费校验逻辑
     - 自核规则校验

2. **线上批改** - 批改接口
   - **配置位置**：需要新建 `backend/routes/endorsements.js`
   - **前端页面**：`pages/Endorsements.tsx`（已存在，需完善）
   - **需要开发**：人员变动、替换等批改操作接口

3. **线上批改试算** - 批改试算接口
   - **配置位置**：需要新建 `backend/routes/endorsements.js` 中的试算接口
   - **需要开发**：使用利宝标准批改保费计算接口

4. **线上撤销** - 订单/批改撤销接口
   - **配置位置**：需要新建 `backend/routes/applications.js` 中的撤销接口
   - **需要开发**：未缴费前的投保单和批单撤销功能

5. **线上退保** - 退保接口
   - **配置位置**：需要新建 `backend/routes/policies.js` 中的退保接口
   - **需要开发**：未生效保单的退保功能

6. **线上缴费** - 见费出单处理接口
   - **配置位置**：需要新建 `backend/routes/payment.js`
   - **需要开发**：
     - 线上二维码支付接口
     - 线下对公支付接口
     - 聚合支付功能

#### 需要新开发的功能

7. **电子单证自动推送** - 电子保单/批单发送接口
   - **配置位置**：需要新建 `backend/routes/documents.js`
   - **需要开发**：
     - 电子保单自动推送接口
     - 电子批单自动推送接口
     - 电子发票推送接口（普票、专票）
     - 邮件发送功能（专票线下开具场景）

8. **手续费** - 手续费比例
   - **配置位置**：数据库表 `premium_rates` 或新建 `commission_rates` 表
   - **配置字段**：根据方案代码、险种代码、业务关系代码配置手续费比例
   - **需要开发**：手续费计算逻辑

9. **高级查询** - 查询接口
   - **配置位置**：需要完善 `backend/routes/policies.js`
   - **需要开发**：
     - 保单查询（支持多条件查询）
     - 保单打印功能
     - 电子保单/电子发票下载功能

10. **敏感客户查询** - 敏感客户接口
    - **配置位置**：需要新建 `backend/routes/risk-control.js`
    - **需要开发**：
      - 投保人敏感客户检验接口
      - 被保险人敏感客户检验接口
      - 用工单位敏感客户检验接口
    - **调用时机**：提交投保单环节

11. **理赔数据推送** - 理赔数据推送接口
    - **配置位置**：需要新建 `backend/routes/claims.js`
    - **需要开发**：理赔变动数据推送功能（需确认渠道是否有理赔接口）

12. **资料补传** - 资料补传接口
    - **配置位置**：需要新建 `backend/routes/documents.js` 中的补传接口
    - **需要开发**：
      - 投保单补传功能
      - 批改申请书补传功能

13. **保险凭证** - 保险凭证接口
    - **配置位置**：需要新建 `backend/routes/certificates.js`
    - **需要开发**：保险凭证下载功能

### 1.2 产品信息配置

#### 配置位置：数据库表 `insurance_products` 和 `company_liabilities`

**主险责任配置**：
- 产品代码：1601
- 产品名称：雇主责任保险
- 条款代码：16M00031
- 条款名称：利宝保险有限公司雇主责任保险条款（2024版A款）

**需要配置的责任**：
1. **死亡/伤残(不含突发疾病和职业病)** - 责任代码：01824（主险）
2. **医疗费用** - 责任代码：0037（主险）
3. **误工费用** - 责任代码：0040（主险）

**附加险责任配置**：
1. **住院津贴** - 条款代码：16S00083，责任代码：00420
2. **附加突发疾病死亡** - 条款代码：16S00136，责任代码：01671
3. **医疗费用范围扩展** - 条款代码：16S00066，责任代码：0509
4. **转院就医食宿交通费** - 条款代码：16S00063，责任代码：00481
5. **残疾辅助器具费用** - 条款代码：16S00079，责任代码：00478
6. **二十四小时责任**（4个责任）：
   - 死亡/伤残：01521
   - 医疗费用：01522
   - 误工费用：01525
   - 住院津贴：01524

**特约条款配置**：
- 需要新建 `special_agreements` 表存储特约条款
- 配置所有特约条款代码和名称

### 1.3 业务规则配置

#### 配置位置：数据库表 `insurance_api_configs` 的 `intercept_rules_json` 字段

**需要配置的规则**：

1. **规则校验流程**
   - 配置位置：`backend/routes/applications.js` 中的校验逻辑
   - 需要实现：
     - 基础校验通过后自动生成投保申请单
     - 基础校验未通过返回错误信息

2. **允许承保区域**
   - 禁保地区：西藏、新疆、青海
   - 配置位置：`insurance_api_configs.intercept_rules_json`
   - 接口强制判断

3. **投/被保险人规则**
   - 投/被保险人非必须保持一致
   - 被保险人重复投保拒保（和非本渠道保单检验）
   - 配置位置：`backend/routes/applications.js` 中的校验逻辑

4. **最低在保人数**
   - 要求：3人（含）以上
   - 配置位置：`insurance_api_configs.intercept_rules_json`
   - 接口强制判断（投保、批改）

5. **雇员年龄**
   - 要求：年满16周岁至65周岁（含）
   - 配置位置：`insurance_api_configs.intercept_rules_json`
   - 接口强制判断（投保、批改）

6. **职业类别**
   - 要求：参考专属职业分类表
   - 配置位置：数据库表 `occupation_categories`（需要新建）
   - 接口强制判断（投保、批改）

7. **保险期限**
   - 支持：年单、月单
   - 配置位置：`product_plans.duration_options`

8. **批改规则**
   - 配置位置：`backend/routes/endorsements.js`
   - 需要实现：
     - 人员替换（一增一减不涉及保费变化）
     - 批减人员（按日比例计算）
     - 批增人员（按日比例计算）
     - 保单注销（起保前，全额退还）
     - 保单退保（起保后，按日比例计算，月单不支持）

---

## 二、系统监控规则（工作表2：通过系统监控的规则）

### 2.1 控制点配置

#### 配置位置：`insurance_api_configs.intercept_rules_json`

**需要配置的规则**：

1. **投保人/被保险人地区限制**
   - 拒保地区：西藏、新疆、青海
   - 配置字段：`region_restrictions`
   - 需要录入：省市-区县

2. **司法管辖**
   - 默认值：诉讼
   - 配置字段：`legal_jurisdiction`

3. **雇员年龄**
   - 要求：年满16周岁不超过65周岁
   - 配置字段：`employee_age_range`

4. **职业工种**
   - 要求：按照专属职业分类表
   - 配置位置：数据库表 `occupation_categories`（需要新建）

5. **重复投保校验**
   - 校验内容：相同投保人、相同被保险人、相同雇员（通过身份证号码判断）
   - 配置位置：`backend/routes/applications.js` 中的校验逻辑
   - 前端提示：前端页面提示
   - 数据源：使用我司有效保单数据进行校验

6. **投保份数限制**
   - 要求：相同雇员限1份（以身份证校验）
   - 配置位置：`backend/routes/applications.js` 中的校验逻辑
   - 数据源：同时校验双方数据库

7. **所需资料**
   - 新保：营业执照、人员清单、投保单
   - 续保：上年度电子保单、营业执照、人员清单、投保单
   - 配置位置：前端页面提示，后端接口校验

8. **投保单-人员清单**
   - 要求：使用现有雇员清单模板（增加餐饮品牌字段）
   - 配置位置：前端页面 `pages/NewPolicy.tsx` 中的被保人信息表格

9. **投保单**
   - 要求：用印完成版电子投保单前端传入
   - 配置位置：前端文件上传功能，后端文件存储

10. **职业类别表**
    - 要求：利宝提供经过筛选后的职业类别表（渠道专属版）
    - 配置位置：数据库表 `occupation_categories`（需要新建）

11. **最低在保人数**
    - 要求：3人（含）以上（含批改后）
    - 配置位置：`insurance_api_configs.intercept_rules_json`

12. **敏感客户**
    - 要求：接入数据（利宝敏感客户）
    - 配置位置：需要新建 `sensitive_customers` 表或调用利宝接口

---

## 三、承保方案（工作表3：承保方案）

### 3.1 方案配置

#### 配置位置：数据库表 `product_plans` 和 `plan_liabilities`

**方案一和方案二配置**：

**方案一**：
- 方案代码：需要配置（如：PLAN_01）
- 方案名称：利宝保险雇主责任保险-乐选-方案一
- 死亡/伤残赔偿限额：100万
- 医疗费赔偿限额：9万（免赔额0元，100%赔付）
- 误工费用：200元/人/天（免赔天数0天，赔偿天数365天为限）
- 住院津贴：60元/人/天（免赔天数0天，赔偿天数365天为限）
- 附加突发疾病死亡赔偿限额：100万
- 附加医疗费用范围扩展：9万
- 附加转院就医食宿交通费限额：2500元
- 附加残疾辅助器具费用限额：2500元
- 附加二十四小时责任死亡/伤残限额：20万
- 附加二十四小时责任医疗费用限额：3万
- 附加二十四小时责任住院津贴：60元/人/天
- 法律费用：每次事故5万/累计5万
- 保费：28元/人/月 或 336元/人/年

**方案二**：
- 方案代码：需要配置（如：PLAN_02）
- 方案名称：利宝保险雇主责任保险-乐选-方案二
- 与方案一的主要差异：
  - 附加二十四小时责任医疗费用限额：5万（方案一是3万）
  - 附加二十四小时责任误工费用：200元/人/天（方案一没有）
- 保费：29元/人/月 或 344元/人/年

### 3.2 前端传值标识

#### 配置位置：前端 `pages/NewPolicy.tsx` 和接口参数

**需要增加的字段**：

1. **投保类型标识**
   - 字段名：`policy_type` 或 `renewal_flag`
   - 可选值：
     - 新保：本平台首年投保
     - 续保：平台续保今年转利宝
     - 优续：利宝续保
   - 配置位置：前端选择框，接口参数

2. **伤残比例传值**
   - 字段名：`disability_ratio`
   - 配置位置：接口参数，存入死亡伤残责任
   - 需要开发：接口增加此字段

3. **是否涉高传值**
   - 字段名：`is_high_risk_work`
   - 配置位置：接口参数，存入方案问卷
   - 需要开发：接口增加此字段

### 3.3 行业系数配置

#### 配置位置：数据库表 `industry_factors`（需要新建）

**需要配置的行业系数**：
- 根据行业名称配置系数（0.5-1.0）
- 例如：餐饮业0.7，水上运输业1.0，保险业0.5等
- 用于保费计算

### 3.4 佣金系数配置

#### 配置位置：数据库表 `commission_rates`（需要新建）

**佣金比例选项**：
- 0%、5%、10%、15%、20%、25%
- 计算公式：基础保费*(1+佣金比例)
- 根据方案自动判断

### 3.5 保期系数配置

#### 配置位置：数据库表 `duration_factors`（需要新建）

**保期系数**：
- 1个月：0.15
- 2个月：0.25
- 3个月：0.35
- 4个月：0.45
- 5个月：0.6
- 6个月：0.7
- 7个月：0.75
- 8个月：0.8
- 9个月：0.85
- 10个月：0.9
- 11个月：0.95
- 12个月：1.0

---

## 四、适用条款（工作表4：适用条款）

### 4.1 条款配置

#### 配置位置：数据库表 `insurance_clauses`（需要新建）或 `insurance_products` 表扩展

**主险条款**：
- 条款名称：利宝保险有限公司雇主责任保险条款（2024版A款）
- 注册号：C00006030912024080703473
- 配置位置：`insurance_products.registration_no` 和 `insurance_products.registration_name`

**附加险条款**（需要配置）：
1. 住院津贴保险条款 - C00006030922019123105012
2. 突发疾病死亡保险条款（A款） - C00006030922023100862251
3. 医疗费用范围扩展保险条款（A款） - C00006030922023020522733
4. 转院就医食宿交通费扩展条款 - C00006030922019122511161
5. 残疾辅助器具费用保险条款（A款） - C00006030922023020522603
6. 二十四小时责任扩展保险条款（C款） - C00006030922023100862221

**特约条款**（需要配置）：
1. 高风险工种除外特约 - H00006030922016112922541
2. 附加传染病责任免除条款 - C00006031922021012002402
3. 附加雇员承保年龄保险条款 - C00006030922023040461183
4. 附加雇员高风险职业除外保险条款 - C00006030922023040461193
5. 附加雇员列明承保职业保险条款 - C00006030922023040461203
6. 附加伤残赔偿比例调整保险条款（A款） - C00006030922023020522683
7. 附加提前三十天通知解除合同保险条款 - C00006030922023040461263
8. 附加四十八小时内及时报案通知保险条款 - C00006030922023040461270
9. 已退保雇员保险金扣除特别约定 - SE0684
10. 责任险高空作业除外特约 - SE7372

---

## 五、系统配置方案（工作表5：系统配置方案）

### 5.1 方案代码和名称配置

#### 配置位置：数据库表 `product_plans`

**需要配置的方案**：
1. 方案代码：PLAN_01（或自定义）
   - 方案名称：利宝保险雇主责任保险-乐选-方案一

2. 方案代码：PLAN_02（或自定义）
   - 方案名称：利宝保险雇主责任保险-乐选-方案二

---

## 六、特别约定（工作表6：特别约定）

### 6.1 特别约定配置

#### 配置位置：数据库表 `special_agreements`（需要新建）

**需要配置的特别约定**：

1. **医疗费用免赔条件特别约定**（联动展示）
   - 配置位置：`special_agreements` 表
   - 关联字段：方案ID
   - 内容：医疗费用免赔额为0元，100%赔付

2. **误工费用免赔条件特别约定**（联动展示）
   - 配置位置：`special_agreements` 表
   - 关联字段：方案ID
   - 内容：误工费用200元/天，免赔天数0天，赔偿天数365天为限

3. **住院津贴免赔条件特别约定**（联动展示）
   - 配置位置：`special_agreements` 表
   - 关联字段：方案ID
   - 内容：住院津贴60元/天，免赔天数0天，赔偿天数365天为限

4. **雇主责任保险附加二十四小时责任扩展特别约定**
   - 配置位置：`special_agreements` 表
   - 内容：伤残等级1-10级赔付比例（100%到10%）

5. **高风险工种除外特约**
   - 注册号：H00006030922016112922541
   - 配置位置：`special_agreements` 表

6. **附加传染病责任免除条款**
   - 注册号：C00006031922021012002402
   - 配置位置：`special_agreements` 表

7. **附加雇员承保年龄保险条款**（联动展示）
   - 注册号：C00006030922023040461183
   - 配置位置：`special_agreements` 表
   - 内容：年龄范围16周岁-65周岁（含）

8. **附加雇员列明承保职业保险条款**（联动展示）
   - 注册号：C00006030922023040461203
   - 配置位置：`special_agreements` 表

9. **附加伤残赔偿比例调整保险条款（A款）**（联动展示）
   - 注册号：C00006030922023020522683
   - 配置位置：`special_agreements` 表
   - 内容：1-10级伤残赔付比例

10. **附加提前三十天通知解除合同保险条款**
    - 注册号：C00006030922023040461263
    - 配置位置：`special_agreements` 表

---

## 七、职业分类表（工作表7：职业分类表_专属）

### 7.1 职业分类表配置

#### 配置位置：数据库表 `occupation_categories`（需要新建）

**表结构设计**：
- `occupation_id`：职业ID（主键）
- `industry_large_code`：行业大分类代码
- `industry_large_name`：行业大分类名称
- `industry_medium_code`：行业中分类代码
- `industry_medium_name`：行业中分类名称
- `industry_small_name`：行业小分类名称
- `occupation_detail_code`：职业细类代码
- `occupation_detail_name`：职业细类名称
- `occupation_level`：职业等级（1-5类）
- `status`：状态（启用/禁用）

**需要导入的数据**：
- 从Excel表格中导入所有职业分类数据
- 共69行数据（包含表头）
- 职业等级范围：1-5类

**配置位置**：
- 后台管理系统：`admin/src/pages/OccupationList.tsx`（需要新建）
- 前端选择：`pages/NewPolicy.tsx` 中的职业选择功能

---

## 八、人员清单（工作表8：人员清单）

### 8.1 人员清单字段配置

#### 配置位置：数据库表 `insured_persons` 和前端页面

**必填字段**（红字标记）：
1. 雇员姓名 - `insured_persons.name`
2. 证件类型 - `insured_persons.id_type`
3. 证件号码 - `insured_persons.id_number`
4. 职业细类代码 - `insured_persons.job_code`
5. 职业等级 - `insured_persons.job_category`
6. 职业细类名称 - `insured_persons.job_name`
7. 职务/工种描述 - 需要新增字段 `insured_persons.job_description`

**多方案时必填**：
8. 方案号 - `insured_persons.instance_id`（关联 `application_plans`）

**其他字段**：
9. 批改标志(D/I/U) - 需要新增字段 `insured_persons.endorsement_flag`
10. 国籍 - 需要新增字段 `insured_persons.nationality`
11. 出生日期 - `insured_persons.birth_date`
12. 性别 - `insured_persons.gender`
13. 年龄 - 根据出生日期计算
14. 月工资币别 - 需要新增字段 `insured_persons.salary_currency`
15. 月工资金额 - 需要新增字段 `insured_persons.monthly_salary`
16. 赔偿月数 - 需要新增字段 `insured_persons.compensation_months`
17. 用工单位 - 需要新增字段 `insured_persons.employer_unit`（被保险人为非实际用工单位时必填）
18. 用工地点 - 需要新增字段 `insured_persons.work_location`
19. **餐饮品牌** - 需要新增字段 `insured_persons.restaurant_brand`（新增字段）
20. 是否参保工伤保险 - 需要新增字段 `insured_persons.has_work_injury_insurance`
21. **是否涉及高处作业** - 需要新增字段 `insured_persons.is_high_risk_work`（新增字段）
22. 备注 - 需要新增字段 `insured_persons.remarks`

**前端页面配置**：
- 位置：`pages/NewPolicy.tsx` 中的被保人信息表格
- 需要增加：餐饮品牌、是否涉及高处作业等字段的输入框

---

## 九、需要新建的数据库表

### 9.1 职业分类表
```sql
CREATE TABLE `occupation_categories` (
  `occupation_id` BIGINT NOT NULL AUTO_INCREMENT,
  `industry_large_code` VARCHAR(20),
  `industry_large_name` VARCHAR(100),
  `industry_medium_code` VARCHAR(20),
  `industry_medium_name` VARCHAR(100),
  `industry_small_name` VARCHAR(100),
  `occupation_detail_code` VARCHAR(20) NOT NULL,
  `occupation_detail_name` VARCHAR(200) NOT NULL,
  `occupation_level` INT NOT NULL COMMENT '职业等级1-5',
  `status` VARCHAR(20) DEFAULT '启用',
  PRIMARY KEY (`occupation_id`),
  KEY `idx_occupation_code` (`occupation_detail_code`),
  KEY `idx_occupation_level` (`occupation_level`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
```

### 9.2 特别约定表
```sql
CREATE TABLE `special_agreements` (
  `agreement_id` BIGINT NOT NULL AUTO_INCREMENT,
  `plan_id` BIGINT,
  `agreement_code` VARCHAR(50),
  `agreement_name` VARCHAR(200),
  `agreement_content` TEXT,
  `registration_no` VARCHAR(100),
  `is_linked` BOOLEAN DEFAULT FALSE COMMENT '是否联动展示',
  `display_order` INT DEFAULT 0,
  `status` VARCHAR(20) DEFAULT '启用',
  PRIMARY KEY (`agreement_id`),
  KEY `idx_plan_id` (`plan_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
```

### 9.3 行业系数表
```sql
CREATE TABLE `industry_factors` (
  `factor_id` BIGINT NOT NULL AUTO_INCREMENT,
  `industry_name` VARCHAR(200) NOT NULL,
  `factor_value` DECIMAL(5,2) NOT NULL,
  `status` VARCHAR(20) DEFAULT '启用',
  PRIMARY KEY (`factor_id`),
  UNIQUE KEY `uk_industry_name` (`industry_name`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
```

### 9.4 佣金系数表
```sql
CREATE TABLE `commission_rates` (
  `rate_id` BIGINT NOT NULL AUTO_INCREMENT,
  `plan_id` BIGINT,
  `commission_percentage` DECIMAL(5,2) NOT NULL COMMENT '佣金比例0-25',
  `formula` VARCHAR(200) COMMENT '计算公式',
  `status` VARCHAR(20) DEFAULT '启用',
  PRIMARY KEY (`rate_id`),
  KEY `idx_plan_id` (`plan_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
```

### 9.5 保期系数表
```sql
CREATE TABLE `duration_factors` (
  `factor_id` BIGINT NOT NULL AUTO_INCREMENT,
  `duration_months` INT NOT NULL COMMENT '保期月数1-12',
  `factor_value` DECIMAL(5,2) NOT NULL,
  `status` VARCHAR(20) DEFAULT '启用',
  PRIMARY KEY (`factor_id`),
  UNIQUE KEY `uk_duration_months` (`duration_months`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
```

### 9.6 敏感客户表
```sql
CREATE TABLE `sensitive_customers` (
  `id` BIGINT NOT NULL AUTO_INCREMENT,
  `customer_type` VARCHAR(20) NOT NULL COMMENT '客户类型：投保人/被保险人/用工单位',
  `customer_name` VARCHAR(200),
  `customer_id_number` VARCHAR(50),
  `customer_code` VARCHAR(50),
  `risk_level` VARCHAR(20),
  `source` VARCHAR(50) DEFAULT '利宝',
  `created_at` DATETIME DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  KEY `idx_customer_type` (`customer_type`),
  KEY `idx_customer_id_number` (`customer_id_number`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
```

---

## 十、需要扩展的现有表字段

### 10.1 `insured_persons` 表扩展字段
- `job_description` VARCHAR(200) COMMENT '职务/工种描述'
- `endorsement_flag` VARCHAR(1) COMMENT '批改标志D/I/U'
- `nationality` VARCHAR(50) COMMENT '国籍'
- `salary_currency` VARCHAR(10) COMMENT '月工资币别'
- `monthly_salary` DECIMAL(10,2) COMMENT '月工资金额'
- `compensation_months` INT COMMENT '赔偿月数'
- `employer_unit` VARCHAR(200) COMMENT '用工单位'
- `work_location` VARCHAR(200) COMMENT '用工地点'
- `restaurant_brand` VARCHAR(100) COMMENT '餐饮品牌'
- `has_work_injury_insurance` BOOLEAN COMMENT '是否参保工伤保险'
- `is_high_risk_work` BOOLEAN COMMENT '是否涉及高处作业'
- `remarks` TEXT COMMENT '备注'

### 10.2 `application_plans` 表扩展字段
- `policy_type` VARCHAR(20) COMMENT '投保类型：新保/续保/优续'
- `disability_ratio` VARCHAR(50) COMMENT '伤残比例'

### 10.3 `plan_instance_liabilities` 表扩展字段
- `disability_ratio` VARCHAR(50) COMMENT '伤残比例（存入死亡伤残责任）'

---

## 十一、需要开发的新接口

### 11.1 批改相关接口
- `POST /api/endorsements` - 创建批改申请
- `POST /api/endorsements/:id/calculate` - 批改试算
- `POST /api/endorsements/:id/cancel` - 撤销批改

### 11.2 支付相关接口
- `POST /api/payment/create` - 创建支付订单
- `POST /api/payment/callback` - 支付回调
- `GET /api/payment/:id/status` - 查询支付状态

### 11.3 文档相关接口
- `POST /api/documents/upload` - 上传文档（投保单、批改申请书）
- `GET /api/documents/:id/download` - 下载文档
- `POST /api/documents/policy/push` - 推送电子保单
- `POST /api/documents/invoice/push` - 推送电子发票

### 11.4 风险控制接口
- `POST /api/risk-control/check` - 敏感客户检验

### 11.5 查询接口
- `GET /api/policies/search` - 高级查询保单
- `GET /api/policies/:id/print` - 打印保单
- `GET /api/certificates/:id` - 获取保险凭证

### 11.6 理赔接口
- `POST /api/claims/push` - 推送理赔数据

---

## 十二、需要完善的前端页面

### 12.1 投保页面 (`pages/NewPolicy.tsx`)
- [ ] 增加投保类型选择（新保/续保/优续）
- [ ] 增加伤残比例选择
- [ ] 增加是否涉高选择
- [ ] 人员清单表格增加餐饮品牌字段
- [ ] 人员清单表格增加是否涉及高处作业字段
- [ ] 人员清单表格增加其他必填字段

### 12.2 批改页面 (`pages/Endorsements.tsx`)
- [ ] 完善批改功能
- [ ] 增加批改试算功能
- [ ] 增加批改撤销功能

### 12.3 后台管理页面
- [ ] 新建职业分类管理页面 (`admin/src/pages/OccupationList.tsx`)
- [ ] 新建特别约定管理页面 (`admin/src/pages/SpecialAgreements.tsx`)
- [ ] 新建行业系数管理页面 (`admin/src/pages/IndustryFactors.tsx`)
- [ ] 新建佣金系数管理页面 (`admin/src/pages/CommissionRates.tsx`)
- [ ] 新建保期系数管理页面 (`admin/src/pages/DurationFactors.tsx`)
- [ ] 新建敏感客户管理页面 (`admin/src/pages/SensitiveCustomers.tsx`)

---

## 十三、配置优先级

### 高优先级（核心功能）
1. 职业分类表配置和导入
2. 方案一和方案二的完整配置
3. 人员清单字段扩展
4. 投保类型、伤残比例、是否涉高等字段增加
5. 基础校验规则配置（地区、年龄、人数等）

### 中优先级（重要功能）
1. 批改功能开发
2. 支付功能开发
3. 敏感客户检验功能
4. 特别约定配置

### 低优先级（辅助功能）
1. 电子单证推送
2. 理赔数据推送
3. 资料补传
4. 保险凭证下载

---

## 十四、注意事项

1. **数据导入**：职业分类表需要从Excel完整导入到数据库
2. **字段扩展**：`insured_persons` 表需要增加多个字段，注意数据迁移
3. **接口开发**：批改、支付等核心功能需要优先开发
4. **规则配置**：所有业务规则需要配置到 `insurance_api_configs.intercept_rules_json`
5. **测试验证**：每个功能开发完成后需要完整测试
6. **文档更新**：配置完成后需要更新相关技术文档

---

**文档生成时间**：2025-12-10
**基于文件**：乐选渠道对接表.xlsx
