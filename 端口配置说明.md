# 端口配置说明

## 一、端口分配

为了避免端口冲突，系统使用以下端口：

| 服务 | 端口 | 说明 |
|------|------|------|
| **用户端** | 5173 | React前端（企业客户使用） |
| **后台管理系统** | 5174 | React前端（内部管理） |
| **后端API服务** | 8888 | Node.js后端服务 |

---

## 二、访问地址

### 用户端
- **开发环境**：http://localhost:5173
- **访问路径**：
  - 首页：http://localhost:5173
  - 投保页面：http://localhost:5173/#/new-policy
  - 登录页面：http://localhost:5173/#/login

### 后台管理系统
- **开发环境**：http://localhost:5174/admin
- **访问路径**：
  - 登录页面：http://localhost:5174/login
  - 仪表盘：http://localhost:5174/admin/dashboard

### 后端API服务
- **API地址**：http://localhost:8888/api
- **健康检查**：http://localhost:8888/health
- **API文档**：
  - 产品列表：http://localhost:8888/api/products
  - 方案列表：http://localhost:8888/api/products/1/plans
  - 等等...

---

## 三、配置文件位置

### 1. 用户端端口配置
**文件**：`vite.config.ts`
```typescript
server: {
  port: 5173,
  host: '0.0.0.0',
}
```

### 2. 后台管理系统端口配置
**文件**：`admin/vite.config.ts`
```typescript
server: {
  port: 5174,
}
```

### 3. 后端API端口配置
**文件**：`backend/.env`
```env
PORT=8888
```

### 4. 前端API地址配置

**用户端API地址**：
- **文件**：`src/services/api.ts`
- **配置**：`http://localhost:8888/api`

**后台管理API地址**：
- **文件**：`admin/src/utils/api.ts`
- **配置**：`http://localhost:8888/api`

---

## 四、修改端口

### 如果需要修改端口

#### 修改用户端端口
1. 编辑 `vite.config.ts`
2. 修改 `server.port` 的值
3. 重启服务

#### 修改后台管理端口
1. 编辑 `admin/vite.config.ts`
2. 修改 `server.port` 的值
3. 重启服务

#### 修改后端API端口
1. 编辑 `backend/.env`
2. 修改 `PORT` 的值
3. 同时修改前端API地址配置
4. 重启服务

---

## 五、启动命令

### 启动所有服务

```bash
# 1. 启动数据库（如果还没启动）
docker start mysql-insurance

# 2. 启动后端API（新终端）
cd backend
npm run dev

# 3. 启动用户端（新终端）
cd /Users/cc/insuranceplateform
npm run dev

# 4. 启动后台管理（新终端）
cd admin
npm run dev
```

---

## 六、验证端口

### 检查端口是否被占用

```bash
# 检查5173端口
lsof -i :5173

# 检查5174端口
lsof -i :5174

# 检查8888端口
lsof -i :8888
```

### 测试服务是否启动

```bash
# 测试后端API
curl http://localhost:8888/health

# 测试用户端（需要浏览器）
open http://localhost:5173

# 测试后台管理（需要浏览器）
open http://localhost:5174/admin
```

---

## 七、常见问题

### 问题1：端口被占用

**现象**：启动失败，提示端口被占用

**解决**：
```bash
# 查看占用进程
lsof -i :5173
lsof -i :5174
lsof -i :8080

# 杀死进程
kill -9 <PID>

# 或者修改端口配置
```

### 问题2：前端无法连接后端

**现象**：前端报错，无法获取数据

**解决**：
1. 检查后端是否启动：`curl http://localhost:8888/health`
2. 检查API地址配置是否正确
3. 检查CORS配置（后端已配置允许所有来源）

### 问题3：端口冲突

**现象**：Vite自动使用其他端口

**解决**：
- 检查终端输出，看实际使用的端口
- 或者修改配置文件，使用其他端口

---

## 八、端口选择建议

### 推荐端口范围

- **前端服务**：5173-5200（Vite默认范围）
- **后端服务**：8000-8999（常用后端端口）
- **数据库**：3306（MySQL默认）

### 当前配置

- ✅ 用户端：5173（Vite常用端口）
- ✅ 后台管理：5174（Vite常用端口）
- ✅ 后端API：8888（常用后端端口）

---

**所有端口已配置完成，可以启动服务了！** 🎉

