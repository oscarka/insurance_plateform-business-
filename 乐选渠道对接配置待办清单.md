# 乐选渠道对接配置待办清单

本文档列出所有需要配置、修改、实现的任务（不包括接口开发），按优先级和类别组织。

---

## 📋 任务分类说明

- ✅ 已完成
- 🔄 进行中
- ⏳ 待开始
- ❌ 已取消

---

## 一、数据库表结构（高优先级）

### 1.1 新建数据库表

#### ⏳ 任务1：创建职业分类表 `occupation_categories`
- **表结构**：
  - `occupation_id` BIGINT 主键
  - `company_id` BIGINT NOT NULL 保司ID（外键，关联insurance_companies）⭐新增
  - `industry_large_code` VARCHAR(20) 行业大分类代码
  - `industry_large_name` VARCHAR(100) 行业大分类名称
  - `industry_medium_code` VARCHAR(20) 行业中分类代码
  - `industry_medium_name` VARCHAR(100) 行业中分类名称
  - `industry_small_name` VARCHAR(100) 行业小分类名称
  - `occupation_detail_code` VARCHAR(20) NOT NULL 职业细类代码
  - `occupation_detail_name` VARCHAR(200) NOT NULL 职业细类名称
  - `occupation_level` INT NOT NULL 职业等级1-5
  - `industry_factor` DECIMAL(5,2) 行业系数（用于保费计算）⭐新增：合并任务3的行业系数
  - `status` VARCHAR(20) DEFAULT '启用'
  - 索引：`idx_company_id`, `idx_occupation_code` (company_id, occupation_detail_code), `idx_occupation_level`
  - 外键：`fk_oc_company` FOREIGN KEY (`company_id`) REFERENCES `insurance_companies` (`company_id`)
- **执行位置**：`database_schema.sql` 或新建迁移脚本
- **备注**：
  - 需要区分不同保险公司的职业表（每家保险公司都有自己的职业代码表）
  - 行业系数合并到此表（对应Excel"承保方案"工作表中的行业系数列，约60+个行业）
  - 需要从Excel导入69条职业分类数据（关联到利宝保险公司）
  - 未来其他保险公司会有自己的职业分类表数据

#### ⏳ 任务2：创建特别约定表 `special_agreements`
- **表结构**：
  - `agreement_id` BIGINT 主键
  - `company_id` BIGINT NOT NULL 保司ID（外键，关联insurance_companies）⭐新增
  - `clause_id` BIGINT 条款ID（外键，关联insurance_clauses，可空）⭐新增：特约关联到条款
  - `liability_id` BIGINT 责任ID（外键，关联company_liabilities，可空）⭐修改：从plan_id改为liability_id
  - `product_id` BIGINT 产品ID（外键，关联insurance_products，可空）⭐新增：特约关联到产品
  - `plan_id` BIGINT 方案ID（外键，关联product_plans，可空）⭐新增：特约关联到方案
  - `link_type` VARCHAR(20) DEFAULT 'clause' 关联类型（clause=条款，liability=责任，product=产品，plan=方案）⭐新增
  - `agreement_code` VARCHAR(50) 约定代码
  - `agreement_name` VARCHAR(200) 约定名称
  - `agreement_content` TEXT 约定内容
  - `registration_no` VARCHAR(100) 注册号
  - `is_linked` BOOLEAN DEFAULT FALSE 是否联动展示
  - `display_order` INT DEFAULT 0 显示顺序
  - `status` VARCHAR(20) DEFAULT '启用'
  - 索引：`idx_company_id`, `idx_clause_id`, `idx_liability_id`, `idx_product_id`, `idx_plan_id`, `idx_link_type`
  - 外键：`fk_sa_company` FOREIGN KEY (`company_id`) REFERENCES `insurance_companies` (`company_id`)
  - 外键：`fk_sa_clause` FOREIGN KEY (`clause_id`) REFERENCES `insurance_clauses` (`clause_id`)
  - 外键：`fk_sa_liability` FOREIGN KEY (`liability_id`) REFERENCES `company_liabilities` (`liability_id`)
  - 外键：`fk_sa_product` FOREIGN KEY (`product_id`) REFERENCES `insurance_products` (`product_id`) ⭐新增
  - 外键：`fk_sa_plan` FOREIGN KEY (`plan_id`) REFERENCES `product_plans` (`plan_id`) ⭐新增
- **执行位置**：`database_schema.sql` 或新建迁移脚本
- **备注**：
  - 需要区分不同保险公司的特约（每家保险公司有自己的特约条款）
  - 联动展示逻辑：
    - 如果特约关联了责任（liability_id不为空，link_type='liability'）：客户选择了相关责任时，就要显示这条特约
    - 如果特约只关联了条款（clause_id不为空，link_type='clause'）：直接展示，不需要选择责任
    - 如果特约关联了产品（product_id不为空，link_type='product'）：选择该产品时显示
    - 如果特约关联了方案（plan_id不为空，link_type='plan'）：选择该方案时显示
  - 可以同时关联多个（如：既关联条款又关联产品）
  - 需要配置所有特别约定（关联到利宝保险公司）

#### ❌ 任务3：创建行业系数表 `industry_factors`（已取消）
- **取消原因**：与任务1（职业分类表）重复，行业系数可以合并到职业分类表中
- **替代方案**：在 `occupation_categories` 表中增加 `industry_factor` 字段，用于存储行业系数

#### ❌ 任务4：创建佣金系数表 `commission_rates`（已取消）
- **取消原因**：佣金系数线下记录，不需要在系统中存储

#### ⏳ 任务5：扩展 `premium_rates` 费率表支持方案固定保费
- **对应Excel位置**：工作表"承保方案"第16-17行（保费部分：28/人/月、29/人/月）
- **用途说明**：当前产品不同方案每个月有固定金额的月保费，不是通过系数计算
  - 方案一：28元/人/月（336元/人/年）
  - 方案二：29元/人/月（344元/人/年）
- **设计方案**：在现有的 `premium_rates` 费率表中增加字段，支持两种保费计算方式：
  1. **按责任计算**（原有方式）：通过责任、职业类别、保额等维度计算保费
  2. **方案固定保费**（新增方式）：方案级别的固定月保费和年保费
- **需要添加的字段**：
  - `plan_id` BIGINT COMMENT '方案ID（外键，关联product_plans，可空）' ⭐新增
    - 当 plan_id 不为空时，表示这是方案级别的固定保费
    - 当 plan_id 为空时，表示这是按责任计算的费率（原有逻辑）
  - `premium_type` VARCHAR(20) DEFAULT '费率计算' COMMENT '保费类型（费率计算/固定保费）' ⭐新增
    - '费率计算'：按责任、职业类别、保额等维度计算（原有方式）
    - '固定保费'：方案级别的固定月保费和年保费（新增方式）
  - `monthly_premium` DECIMAL(10,2) COMMENT '月保费金额（元/人/月，固定保费时使用）' ⭐新增
  - `annual_premium` DECIMAL(10,2) COMMENT '年保费金额（元/人/年，固定保费时使用）' ⭐新增
- **需要添加的索引和外键**：
  - 索引：`idx_plan_id` (plan_id)
  - 外键：`fk_pr_plan` FOREIGN KEY (`plan_id`) REFERENCES `product_plans` (`plan_id`)
- **执行位置**：数据库迁移脚本，扩展 `premium_rates` 表
- **备注**：
  - 兼容现有费率计算逻辑（plan_id为空时，按原有方式计算）
  - 支持方案固定保费（plan_id不为空且premium_type='固定保费'时，直接使用monthly_premium和annual_premium）
  - 未来如果其他产品需要按保期系数计算，可以继续扩展此表

#### ❌ 任务6：创建敏感客户表 `sensitive_customers`（暂时取消）
- **取消原因**：不确定保司给的接口是直接校验还是会传一个人名单给我，暂时不做
- **待确认**：需要确认保司接口的实现方式后再决定是否创建此表

---

### 1.2 扩展现有表字段

#### ⏳ 任务7：扩展 `company_liabilities` 表字段
- **需要添加的字段**：
  1. `is_additional` BOOLEAN DEFAULT FALSE COMMENT '是否附加险（true=附加险，false=主险）' ⭐新增
  2. `clause_id` BIGINT COMMENT '条款ID（外键，关联insurance_clauses）' ⭐新增
- **需要添加的外键**：
  - `fk_cl_clause` FOREIGN KEY (`clause_id`) REFERENCES `insurance_clauses` (`clause_id`)
- **执行位置**：数据库迁移脚本
- **备注**：
  - 每条责任都需要关联到对应的条款（条款表设计见任务12）
  - 需要标识责任是主险还是附加险

#### ⏳ 任务7-1：扩展 `insured_persons` 表字段
- **设计方案**：分为两部分
  1. **系统基础信息字段**（必填，用于用户基础信息校验）：
     - `name` VARCHAR(100) NOT NULL COMMENT '姓名'（已有）
     - `id_type` VARCHAR(20) NOT NULL COMMENT '证件类型'（已有）
     - `id_number` VARCHAR(50) NOT NULL COMMENT '证件号码'（已有）
  2. **产品特定必填字段**（根据产品要求，Excel中红字标记的字段）：
     - `occupation_detail_code` VARCHAR(20) COMMENT '职业细类代码' ⭐新增
     - `occupation_level` INT COMMENT '职业等级' ⭐新增
     - `occupation_detail_name` VARCHAR(200) COMMENT '职业细类名称' ⭐新增
     - `job_description` VARCHAR(200) COMMENT '职务/工种描述' ⭐新增
  3. **扩展信息字段**（存储为JSON，用于记录其他非必填字段）：
     - `extended_info` JSON COMMENT '扩展信息（JSON格式）' ⭐新增
     - 包含字段：方案号、用工单位、批改标志、国籍、出生日期、性别、年龄、月工资币别、月工资金额、赔偿月数、用工地点、餐饮品牌、是否参保工伤保险、是否涉及高处作业、备注等
- **执行位置**：数据库迁移脚本
- **备注**：
  - 基础信息字段用于系统本身的用户基础信息校验
  - 产品特定必填字段根据Excel红字标记配置
  - 其他字段存储在JSON中，便于扩展和维护

#### ⏳ 任务8：扩展 `applications` 表字段（投保单级别）
- **对应Excel位置**：工作表"承保方案"第1行（前端增加传值标识部分）
- **说明**：
  - Excel第1行提到："前端增加传值标识：新保：本平台首年投保；续保：平台续保今年转利宝；优续：利宝续保"
  - Excel第1行提到："前端增加：伤残比例传值和是否涉高传值；接口增加伤残比例传值并存入死亡伤残责任上"
  - **但**：承保方案中没有看到关于伤残比例的展示要求，只是传值，暂时不存储
- **需要添加的字段**：
  1. `policy_type` VARCHAR(20) COMMENT '投保类型：新保/续保/优续' ⭐新增
     - 说明：先不做续保功能，只支持"新保"
     - 可以有多个投保单，对应用户系统的保单缓存，对应后台系统的投保单
  2. `is_high_risk_work` BOOLEAN COMMENT '是否涉及高处作业' ⭐新增
     - 说明：存入方案问卷（根据Excel说明）
- **不添加的字段**：
  - `disability_ratio`（伤残比例）：暂时不存，没看到承保方案说关于伤残比例的展示
- **执行位置**：数据库迁移脚本
- **备注**：
  - 伤残比例在Excel中的位置：工作表"承保方案"第1行提到"接口增加伤残比例传值并存入死亡伤残责任上"，但只是传值，没有展示要求，暂时不存储

#### ❌ 任务9：扩展 `plan_instance_liabilities` 表字段（暂时不做）
- **取消原因**：暂时不做，待后续需求明确后再处理

---

## 二、数据配置（高优先级）

### 2.1 产品信息配置

#### ⏳ 任务10：配置主险责任到 `company_liabilities` 表
- **需要配置的责任**：
  1. 死亡/伤残(不含突发疾病和职业病) - 责任代码：01824
  2. 医疗费用 - 责任代码：0037
  3. 误工费用 - 责任代码：0040
- **需要同步完成**：
  - 在 `company_liabilities` 表中增加 `is_additional` BOOLEAN 字段，标识是否附加险（主险为false，附加险为true）⭐新增
  - 确保所有责任都关联到利宝保险公司（company_id）
  - 确保所有责任都关联到对应的条款（clause_id，需要先创建条款表）
- **执行位置**：`backend/init-test-data.sql` 或新建配置脚本
- **检查项**：确认责任代码、责任名称、责任类型、是否附加险标识正确

#### ⏳ 任务11：配置附加险责任到 `company_liabilities` 表
- **需要配置的责任**：
  1. 住院津贴 - 条款代码：16S00083，责任代码：00420
  2. 附加突发疾病死亡 - 条款代码：16S00136，责任代码：01671
  3. 医疗费用范围扩展 - 条款代码：16S00066，责任代码：0509
  4. 转院就医食宿交通费 - 条款代码：16S00063，责任代码：00481
  5. 残疾辅助器具费用 - 条款代码：16S00079，责任代码：00478
  6. 二十四小时责任死亡/伤残 - 条款代码：16S00162，责任代码：01521
  7. 二十四小时责任医疗费用 - 条款代码：16S00162，责任代码：01522
  8. 二十四小时责任误工费用 - 条款代码：16S00162，责任代码：01525
  9. 二十四小时责任住院津贴 - 条款代码：16S00162，责任代码：01524
- **需要同步完成**：
  - 在 `company_liabilities` 表中增加 `is_additional` BOOLEAN 字段，标识是否附加险（附加险为true）⭐新增
  - 确保所有责任都关联到利宝保险公司（company_id）
  - 确保所有责任都关联到对应的条款（clause_id，需要先创建条款表）
- **执行位置**：`backend/init-test-data.sql` 或新建配置脚本

#### ⏳ 任务12：创建条款表并配置条款和特约
- **业务逻辑说明**：
  - 责任是从条款里分出来的，所以每条责任都要匹配到条款
  - 条款需要关联到保司（每家保险公司有自己的条款）
  - 特约条款也是条款的一种，需要存储到条款表中
- **需要新建表**：`insurance_clauses` 条款表
  - **表结构**：
    - `clause_id` BIGINT NOT NULL AUTO_INCREMENT COMMENT '条款ID' 主键
    - `company_id` BIGINT NOT NULL COMMENT '保司ID（外键，关联insurance_companies）'
    - `clause_code` VARCHAR(50) NOT NULL COMMENT '条款代码（保司定义）'
    - `clause_name` VARCHAR(200) NOT NULL COMMENT '条款名称'
    - `clause_type` VARCHAR(20) NOT NULL COMMENT '条款类型（主险/附加险/特约）'
    - `registration_no` VARCHAR(100) COMMENT '注册号'
    - `clause_content` TEXT COMMENT '条款内容'
    - `status` VARCHAR(20) NOT NULL DEFAULT '启用' COMMENT '状态（启用/禁用）'
    - `created_at` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间'
    - `updated_at` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间'
    - PRIMARY KEY (`clause_id`)
    - KEY `idx_company_id` (`company_id`)
    - UNIQUE KEY `uk_company_clause_code` (`company_id`, `clause_code`)
    - CONSTRAINT `fk_ic_company` FOREIGN KEY (`company_id`) REFERENCES `insurance_companies` (`company_id`)
    - ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='保险条款表'
- **需要修改 `company_liabilities` 表**（在任务7中完成）：
  - 增加 `clause_id` BIGINT 字段，关联到 `insurance_clauses` 表
  - 外键：`fk_cl_clause` FOREIGN KEY (`clause_id`) REFERENCES `insurance_clauses` (`clause_id`)
- **需要配置的条款**（主险+附加险+特约，共约16个）：
  - 主险条款：利宝保险有限公司雇主责任保险条款（2024版A款）- 注册号：C00006030912024080703473
  - 附加险条款：6个（住院津贴、突发疾病死亡、医疗费用范围扩展、转院就医食宿交通费、残疾辅助器具费用、二十四小时责任扩展）
  - 特约条款：10个（高风险工种除外、传染病责任免除、雇员承保年龄、雇员高风险职业除外、雇员列明承保职业、伤残赔偿比例调整、提前三十天通知解除合同、四十八小时内及时报案通知、已退保雇员保险金扣除、责任险高空作业除外）
- **执行位置**：`database_schema.sql` 创建条款表，然后新建配置脚本配置条款数据
- **备注**：
  - 所有条款都需要关联到利宝保险公司
  - 配置责任时，需要同时关联到对应的条款

---

### 2.2 方案配置

#### ✅ 任务13：配置方案一到 `product_plans` 表（已完成）
- **方案信息**：
  - 方案代码：PLAN_01
  - 方案名称：利宝保险雇主责任保险-乐选-方案一
  - 职业类别范围：1-5类
  - 保障时间选项：["1年","1个月"]
    - "1年"：按年投保
    - "1个月"：按月投保（每个月单独投保一次）
  - 缴费方式：一次交清
- **执行位置**：`backend/complete-tasks-13-21.js`
- **完成情况**：✅ 已配置完成

#### ✅ 任务14：配置方案二到 `product_plans` 表（已完成）
- **方案信息**：
  - 方案代码：PLAN_02
  - 方案名称：利宝保险雇主责任保险-乐选-方案二
  - 职业类别范围：1-5类
  - 保障时间选项：["1年","1个月"]
    - "1年"：按年投保
    - "1个月"：按月投保（每个月单独投保一次）
  - 缴费方式：一次交清
- **执行位置**：`backend/complete-tasks-13-21.js`
- **完成情况**：✅ 已配置完成

#### ✅ 任务15：配置方案一的责任到 `plan_liabilities` 表（已完成）
- **已配置的责任**（11条）：
  1. 死亡/伤残赔偿限额：100万，保额选项：["100万"]
  2. 医疗费赔偿限额：9万，保额选项：["9万"]
  3. 误工费用：200元/人/天，保额选项：["200元/人/天"]
  4. 住院津贴：60元/人/天，保额选项：["60元/人/天"]
  5. 附加突发疾病死亡赔偿限额：100万，保额选项：["100万"]
  6. 附加医疗费用范围扩展：9万，保额选项：["9万"]
  7. 附加转院就医食宿交通费限额：2500元，保额选项：["2500元"]
  8. 附加残疾辅助器具费用限额：2500元，保额选项：["2500元"]
  9. 附加二十四小时责任死亡/伤残限额：20万，保额选项：["20万"]
  10. 附加二十四小时责任医疗费用限额：3万，保额选项：["3万"]
  11. 附加二十四小时责任住院津贴：60元/人/天，保额选项：["60元/人/天"]
- **执行位置**：`backend/complete-tasks-13-21.js`
- **完成情况**：✅ 已配置完成

#### ✅ 任务16：配置方案二的责任到 `plan_liabilities` 表（已完成）
- **已配置的责任**（12条，与方案一差异）：
  1. 附加二十四小时责任医疗费用限额：5万（方案一是3万）
  2. 附加二十四小时责任误工费用：200元/人/天（方案一没有）
  3. 其他责任与方案一相同
- **执行位置**：`backend/complete-tasks-13-21.js`
- **完成情况**：✅ 已配置完成

---

### 2.3 系数配置

#### ⏳ 任务17：导入职业分类数据到 `occupation_categories` 表
- **数据来源**：
  - 职业分类数据：Excel工作表"职业分类表_专属"（69条记录）
  - ⚠️ **行业系数说明**：需要确认Excel中是否有行业系数数据，如果没有则不需要导入行业系数
- **数据量**：约69条职业分类记录（包含表头）
- **执行位置**：新建数据导入脚本
- **检查项**：
  - 职业细类代码唯一性（在同一保司内）
  - 职业等级范围1-5
  - 行业系数（如果Excel中有）：范围0.5-1.0
  - 所有必填字段完整
  - 关联到利宝保险公司（company_id）
- **备注**：需要先确认Excel中是否有行业系数列，如果没有则只导入职业分类数据

#### ❌ 任务18：导入行业系数数据到 `industry_factors` 表（已取消）
- **取消原因**：任务3已取消，行业系数合并到职业分类表中

#### ❌ 任务19：配置佣金系数到 `commission_rates` 表（已取消）
- **取消原因**：任务4已取消，佣金系数线下记录

#### ✅ 任务20：配置方案固定保费到 `premium_rates` 表（已完成）
- **已配置的固定保费**：
  1. 方案一：28元/人/月，336元/人/年
  2. 方案二：29元/人/月，344元/人/年
- **配置方式**：
  - 在 `premium_rates` 表中插入记录
  - `plan_id` 设置为对应的方案ID
  - `premium_type` 设置为 '固定保费'
  - `monthly_premium` 设置为月保费金额
  - `annual_premium` 设置为年保费金额
- **执行位置**：`backend/complete-tasks-13-21.js`
- **完成情况**：✅ 已配置完成

---

### 2.4 特别约定配置

#### ✅ 任务21：配置特别约定到 `special_agreements` 表（已完成）
- **需要配置的特别约定**（根据Excel特别约定sheet页）：
  
  **已配置的特别约定（10个，关联条款）**：
  1. 高风险工种除外特约（关联条款：SE5106，link_type='clause'）
  2. 附加传染病责任免除条款（关联条款：SE3535，link_type='clause'）
  3. 附加雇员承保年龄保险条款（关联条款：SE2425，关联责任：死亡/伤残，link_type='liability'）
  4. 附加雇员高风险职业除外保险条款（关联条款：SE1545，link_type='clause'）
  5. 附加雇员列明承保职业保险条款（关联条款：SE6626，关联责任：死亡/伤残，link_type='liability'）
  6. 附加伤残赔偿比例调整保险条款（A款）（关联条款：SE7295，关联责任：死亡/伤残，link_type='liability'）
  7. 附加提前三十天通知解除合同保险条款（关联条款：SE5974，link_type='clause'）
  8. 附加四十八小时内及时报案通知保险条款（关联条款：SE5970，link_type='clause'）
  9. 已退保雇员保险金扣除特别约定（关联条款：SE0684，link_type='clause'）
  10. 责任险高空作业除外特约（关联条款：SE7372，link_type='clause'）
  
  **已新增的特别约定（关联产品/方案，Excel中的1-4，17，19，20）**：
  11. **医疗费用免赔条件特别约定**（联动展示）✅
     - 关联类型：`link_type='plan'`
     - 关联方案：方案一、方案二（plan_id）
     - 关联责任：医疗费用（liability_id=0037）
     - 内容：医疗费用免赔额为0元，100%赔付
     - 说明：选择医疗费用责任时显示，且需要关联到具体方案
     - 已配置：2条（方案一和方案二各1条）
  
  12. **误工费用免赔条件特别约定**（联动展示）✅
     - 关联类型：`link_type='plan'`
     - 关联方案：方案一、方案二（plan_id）
     - 关联责任：误工费用（liability_id=0040）
     - 内容：误工费用200元/天，免赔天数0天，赔偿天数365天为限
     - 说明：选择误工费用责任时显示，且需要关联到具体方案
     - 已配置：2条（方案一和方案二各1条）
  
  13. **住院津贴免赔条件特别约定**（联动展示）✅
     - 关联类型：`link_type='plan'`
     - 关联方案：方案一、方案二（plan_id）
     - 关联责任：住院津贴（liability_id=00420）
     - 内容：住院津贴60元/天，免赔天数0天，赔偿天数365天为限
     - 说明：选择住院津贴责任时显示，且需要关联到具体方案
     - 已配置：2条（方案一和方案二各1条）
  
  14. **雇主责任保险附加二十四小时责任扩展特别约定**✅
     - 关联类型：`link_type='product'`
     - 关联产品：雇主责任险A（product_id=1）
     - 关联责任：二十四小时责任相关责任（liability_id=01521）
     - 内容：伤残等级1-10级赔付比例（100%到10%）
     - 说明：选择二十四小时责任时显示
     - 已配置：1条（关联产品）
  
  15. **其他特别约定**（Excel中的17，19，20）✅
     - 关联类型：`link_type='product'`（暂时关联到产品，待确认Excel内容后调整）
     - 关联产品：雇主责任险A（product_id=1）
     - 已配置：3条（特别约定17、19、20，暂时关联到产品）
     - 备注：需要根据Excel特别约定sheet页的具体内容确认后，可能需要调整关联类型
  
- **执行位置**：`backend/complete-tasks-13-21.js`
- **完成情况**：
  - ✅ 已扩展`special_agreements`表，增加`product_id`、`plan_id`、`link_type`字段
  - ✅ 已更新10个已存在的特别约定，添加`link_type`字段
  - ✅ 已新增7个特别约定（关联方案和产品）
  - ✅ Excel中的17、19、20暂时关联到产品（待确认具体内容）
- **关联说明**：
  - **关联类型（link_type）**：
    - `clause`：关联到条款（clause_id不为空）
    - `liability`：关联到责任（liability_id不为空）
    - `product`：关联到产品（product_id不为空）
    - `plan`：关联到方案（plan_id不为空）
  - **联动展示逻辑**：
    - 如果`link_type='liability'`：客户选择了相关责任时显示
    - 如果`link_type='clause'`：直接展示，不需要选择责任
    - 如果`link_type='product'`：选择该产品时显示
    - 如果`link_type='plan'`：选择该方案时显示
  - 可以同时关联多个（如：既关联责任又关联方案）
- **备注**：
  - 需要先扩展`special_agreements`表，增加`product_id`、`plan_id`、`link_type`字段
  - 需要根据Excel特别约定sheet页确认17、19、20的具体内容和关联方式

---

### 2.5 拦截规则配置

#### ⏳ 任务22：配置地区限制规则并通过后端校验
- **规则说明**：在投保页面收集企业所在地信息，通过后端接口进行地区限制校验
- **规则内容**：
  - 拒保地区：西藏、新疆、青海
  - 校验对象：投保企业所在地（企业信息中的"企业所在地"字段）
  - 需要录入：省市-区县（通过级联选择器选择）
- **实现方式**：
  1. **前端页面**：在 `pages/NewPolicy.tsx` 的企业信息表单中，添加"企业所在地"字段
     - 使用级联选择器（省-市-区三级）
     - 数据来源：`regions` 表（需要先创建地区表，见任务22-1）
  2. **后端校验**：在 `backend/routes/applications.js` 的创建投保单接口中
     - 接收企业所在地信息（省、市、区）
     - 检查是否在拒保地区列表中（西藏、新疆、青海）
     - 如果在拒保地区，返回错误信息，阻止提交
  3. **配置存储**：可以在 `insurance_api_configs.intercept_rules_json` 中配置拒保地区列表
- **执行位置**：
  - 前端：`pages/NewPolicy.tsx` 企业信息表单
  - 后端：`backend/routes/applications.js` 创建投保单接口
- **配置格式**：JSON格式，例如：`{"type": "region_restriction", "denied_regions": ["西藏", "新疆", "青海"]}`

#### ⏳ 任务22-1：创建地区表 `regions` 并导入数据
- **表结构**：
  - `region_id` BIGINT 主键
  - `region_code` VARCHAR(20) 地区编码（国家标准，如：110000=北京市）
  - `region_name` VARCHAR(100) 地区名称
  - `region_level` TINYINT 地区级别（1=省/直辖市/自治区，2=市/地区，3=区/县）
  - `parent_id` BIGINT 父级地区ID
  - `parent_code` VARCHAR(20) 父级地区编码
  - `sort_order` INT 排序顺序
  - `status` VARCHAR(20) 状态（启用/禁用）
- **数据来源**：国家标准地区编码表（GB/T 2260-2007 中华人民共和国行政区划代码）
- **执行位置**：`database_create_regions_table.sql` 或新建迁移脚本
- **备注**：
  - 需要导入完整的省市区三级数据
  - 可以参考公安系统的地区编码表
  - 用于企业所在地的级联选择器

#### ⏳ 任务23：配置年龄限制规则到 `insurance_api_configs.intercept_rules_json`
- **规则说明**：在后台管理系统的拦截规则配置中，添加年龄限制规则
- **规则内容**：
  - 雇员年龄：年满16周岁至65周岁（含）
  - 校验时机：投保、批改
- **实现方式**：
  - 在后台管理系统"拦截规则管理"页面中配置
  - 规则类型：年龄限制
  - 规则值：JSON格式，包含最小年龄和最大年龄
  - 校验逻辑：在投保或批改时，检查被保人年龄是否在16-65周岁范围内
- **执行位置**：后台管理系统 `admin/src/pages/InterceptionRulesList.tsx` 或直接更新数据库 `insurance_api_configs.intercept_rules_json` 字段
- **配置格式**：JSON格式，例如：`{"type": "age_restriction", "min_age": 16, "max_age": 65}`

#### ⏳ 任务24：配置最低在保人数规则到 `insurance_api_configs.intercept_rules_json`
- **规则说明**：在后台管理系统的拦截规则配置中，添加最低在保人数规则
- **规则内容**：
  - 最低在保人数：3人（含）以上
  - 校验时机：投保、批改（含批改后）
- **实现方式**：
  - 在后台管理系统"拦截规则管理"页面中配置
  - 规则类型：人数限制
  - 规则值：JSON格式，包含最低人数
  - 校验逻辑：在投保或批改时，检查投保人数是否达到最低要求（3人）
- **执行位置**：后台管理系统 `admin/src/pages/InterceptionRulesList.tsx` 或直接更新数据库 `insurance_api_configs.intercept_rules_json` 字段
- **配置格式**：JSON格式，例如：`{"type": "min_insured_count", "min_count": 3}`

#### ⏳ 任务25：配置重复投保校验规则（仅校验本平台数据库）
- **规则说明**：在创建投保单时，通过后端接口校验是否重复投保
- **规则内容**：
  - 校验内容：相同投保人、相同被保险人、相同雇员（通过身份证号码判断）
  - 校验范围：**仅校验本平台数据库** ⭐修改
  - 前端提示：如果发现重复，返回错误信息，前端提示用户
- **实现方式**：
  1. **后端校验**：在 `backend/routes/applications.js` 的创建投保单接口中
     - 检查投保人、被保险人、被保人身份证号码是否在本平台数据库中已存在
     - 查询 `applications` 表和 `insured_persons` 表
     - 如果发现重复，返回错误信息，阻止提交
  2. **保司校验**：如果保司数据库中有问题，会在承保接口返回错误信息 ⭐说明
     - 不需要在创建投保单时查询保司数据库
     - 保司会在后续的承保接口中返回校验结果
- **执行位置**：后端 `backend/routes/applications.js` 创建投保单接口
- **备注**：
  - 仅校验本平台数据库，不查询保司数据库
  - 保司的校验会在承保接口返回

#### ⏳ 任务26：配置投保份数限制规则（仅校验本平台数据库）
- **规则说明**：在创建投保单时，通过后端接口校验相同雇员是否已有保单
- **规则内容**：
  - 相同雇员限1份（以身份证校验）
  - 校验范围：**仅校验本平台数据库** ⭐修改（与任务25相同）
- **实现方式**：
  1. **后端校验**：在 `backend/routes/applications.js` 的创建投保单接口中
     - 检查被保人身份证号码是否在本平台数据库中已有保单
     - 查询 `applications` 表和 `insured_persons` 表，关联 `policies` 表
     - 如果已有保单，返回错误信息，阻止提交
  2. **保司校验**：如果保司数据库中有问题，会在承保接口返回错误信息 ⭐说明
     - 不需要在创建投保单时查询保司数据库
     - 保司会在后续的承保接口中返回校验结果
- **执行位置**：后端 `backend/routes/applications.js` 创建投保单接口
- **备注**：
  - 仅校验本平台数据库，不查询保司数据库
  - 保司的校验会在承保接口返回
  - 与任务25的实现方式相同

---

## 三、前端页面修改（中优先级）

### 3.1 投保页面修改

#### ⏳ 任务27-1：在 `pages/NewPolicy.tsx` 企业信息中增加企业所在地字段
- **需要添加**：
  - 级联选择器：企业所在地（省-市-区三级）
  - 字段名：`company_location` 或分别存储 `province`, `city`, `district`
  - 位置：第一步"选择投保方案"页面，企业信息表单中
  - 必填：是
- **数据来源**：`regions` 表（需要先创建地区表，见任务22-1）
- **实现方式**：
  - 使用级联选择器组件（参考其他平台的实现）
  - 第一级：选择省/直辖市/自治区（region_level=1）
  - 第二级：选择市/地区（region_level=2，根据第一级选择）
  - 第三级：选择区/县（region_level=3，根据第二级选择）
- **执行位置**：`pages/NewPolicy.tsx` 的企业信息表单部分
- **备注**：
  - 需要先完成任务22-1（创建地区表）
  - 需要创建API接口获取地区数据（`/api/regions`）

#### ⏳ 任务27：在 `pages/NewPolicy.tsx` 增加投保类型显示
- **需要添加**：
  - 显示字段：投保类型（显示"新保"，但置灰不让修改）
  - 字段名：`policy_type`
  - 位置：第一步"选择投保方案"页面
  - 默认值：新保
  - UI要求：显示为只读状态，置灰，不可修改
- **执行位置**：`pages/NewPolicy.tsx`
- **备注**：
  - 只显示"新保"，续保/优续暂时不做
  - 需要传递到后端接口，固定传值"新保"
  - 页面显示但不可编辑（置灰状态）

#### ❌ 任务28：在 `pages/NewPolicy.tsx` 增加伤残比例选择（暂时不做）
- **取消原因**：没看到承保方案说关于伤残比例的展示，暂时不存，只传值

#### ⏳ 任务29：在 `pages/NewPolicy.tsx` 增加是否涉高选择
- **需求来源**：需要确认Excel或需求文档中是否有明确要求选择"是否涉及高处作业"
- **需要添加**（待确认需求来源后）：
  - 复选框或选择框：是否涉及高处作业
  - 字段名：`is_high_risk_work`
  - 位置：第一步"选择投保方案"页面，方案配置区域
- **执行位置**：`pages/NewPolicy.tsx`
- **备注**：
  - ⚠️ **待确认**：需要明确需求来源（Excel位置、需求文档位置）
  - 如果确认需要，则传递到后端接口，存入方案问卷（applications表的is_high_risk_work字段）
  - 如果不需要，则取消此任务

#### ❌ 任务30：在 `pages/NewPolicy.tsx` 人员清单表格增加餐饮品牌字段（已取消）
- **取消原因**：暂时不需要此字段
- **原需求说明**：
  - 在人员清单表格中，需要添加"餐饮品牌"字段
  - 字段名：`restaurant_brand`
  - 位置：第二步"填写投保信息"页面，被保人信息表格
  - 必填：是（Excel中红字标记）
- **执行位置**：`pages/NewPolicy.tsx` 的 `InfoFilling` 组件
- **数据存储**：存储在 `insured_persons` 表的 `extended_info` JSON字段中

#### ⏳ 任务31：在 `pages/NewPolicy.tsx` 人员清单表格增加是否涉及高处作业字段
- **需求说明**：
  - 在人员清单表格中，需要添加"是否涉及高处作业"字段
  - 字段名：`is_high_risk_work`
  - 位置：第二步"填写投保信息"页面，被保人信息表格
- **执行位置**：`pages/NewPolicy.tsx` 的 `InfoFilling` 组件
- **数据存储**：存储在 `insured_persons` 表的 `extended_info` JSON字段中
- **备注**：需要确认此字段与任务29的"是否涉高"是否重复，如果重复则合并

#### ⏳ 任务32：在 `pages/NewPolicy.tsx` 人员清单导入模板中增加字段
- **需求说明**：
  - **不在页面填写**：这些字段不需要在页面上填写
  - **导入模板包含**：如果从页面下载"人员清单导入模板"Excel文件，模板中需要包含这些字段
  - **字段列表**：
    1. 职务/工种描述 - `job_description`
    2. 国籍 - `nationality`
    3. 月工资币别 - `salary_currency`
    4. 月工资金额 - `monthly_salary`
    5. 赔偿月数 - `compensation_months`
    6. 用工单位 - `employer_unit`（被保险人为非实际用工单位时必填）
    7. 用工地点 - `work_location`
    8. 是否参保工伤保险 - `has_work_injury_insurance`
    9. 备注 - `remarks`
- **实现方式**：
  1. 在"填写投保信息"页面，提供"下载导入模板"功能
  2. 下载的Excel模板包含所有字段列（包括上述字段）
  3. 用户填写模板后，可以上传导入
  4. 导入的数据存储在 `insured_persons` 表的相应字段中（基础字段直接存储，扩展字段存储在 `extended_info` JSON中）
- **执行位置**：
  - 模板下载功能：`pages/NewPolicy.tsx` 的 `InfoFilling` 组件
  - 模板文件：新建Excel模板文件或通过代码生成
- **备注**：
  - 页面不需要显示这些字段的输入框
  - 只在导入模板中包含这些字段
  - 导入后数据正常存储到数据库

#### ❌ 任务33：在 `pages/NewPolicy.tsx` 增加批改标志字段（暂时不做）
- **取消原因**：批改功能暂时不做，待后续需求明确后再处理
- **原需求**：
  - 选择框：批改标志（D/I/U）
  - 字段名：`endorsement_flag`
  - 位置：批改页面
- **执行位置**：`pages/Endorsements.tsx`（如果存在）或新建批改页面

---

### 3.2 方案选择组件修改

#### ⏳ 任务34：在 `src/components/PlanSelectionDynamic.tsx` 增加投保类型选择
- **需要添加**：
  - 选择框：新保（续保/优续暂时不做）
  - 位置：方案选择区域上方
  - 默认值：新保
- **执行位置**：`src/components/PlanSelectionDynamic.tsx`

#### ⏳ 任务35：在 `src/components/PlanSelectionDynamic.tsx` 增加是否涉高选择
- **需要添加**：
  - 是否涉高复选框
  - 位置：每个方案配置区域内
- **执行位置**：`src/components/PlanSelectionDynamic.tsx`
- **备注**：伤残比例暂时不做

---

## 四、后台管理页面（中优先级）

### 4.1 新建管理页面

#### ⏳ 任务36：创建职业分类管理页面 `admin/src/pages/OccupationList.tsx`
- **功能要求**：
  - 列表展示所有职业分类
  - 支持按行业、职业等级筛选
  - 支持搜索（职业代码、职业名称）
  - 支持导入Excel数据
  - 支持新增、编辑、删除（软删除）
- **执行位置**：新建文件 `admin/src/pages/OccupationList.tsx`
- **参考**：参考 `admin/src/pages/LiabilityList.tsx` 的实现

#### ⏳ 任务37：创建特别约定管理页面 `admin/src/pages/SpecialAgreements.tsx`
- **功能要求**：
  - 列表展示所有特别约定
  - 支持按保司筛选
  - 支持按责任筛选（联动展示相关）
  - 支持搜索（约定名称、注册号）
  - 支持新增、编辑、删除
  - 支持设置是否联动展示
  - 支持关联责任（liability_id）
- **执行位置**：新建文件 `admin/src/pages/SpecialAgreements.tsx`

#### ✅ 任务37-1：创建条款管理页面 `admin/src/pages/ClauseList.tsx`（已完成）
- **功能要求**：
  - 列表展示所有条款（主险、附加险、特约）
  - 支持按保司筛选
  - 支持按条款类型筛选（主险/附加险/特约）
  - 支持搜索（条款名称、注册号、条款代码）
  - 支持新增、编辑、删除
  - 支持查看条款内容
- **执行位置**：已创建文件 `admin/src/pages/ClauseList.tsx`
- **完成情况**：
  - ✅ 已创建页面文件
  - ✅ 已添加到路由（`/admin/clauses`）
  - ✅ 已添加到菜单（配置管理 > 条款管理）
  - ✅ API接口已就绪（`/api/clauses`）

#### ⏳ 任务37-2：扩展费率管理页面支持方案固定保费配置
- **功能要求**：
  - 在现有的费率管理页面（`admin/src/pages/RateList.tsx`）中增加功能：
  - 支持按保费类型筛选（费率计算/固定保费）
  - 支持按方案筛选（当保费类型为固定保费时）
  - 支持新增方案固定保费（选择方案，输入月保费和年保费）
  - 支持编辑方案固定保费
  - 支持删除方案固定保费
- **执行位置**：修改现有文件 `admin/src/pages/RateList.tsx`
- **备注**：不需要新建页面，在现有费率管理页面中扩展功能即可

#### ❌ 任务38：创建行业系数管理页面（已取消）
- **取消原因**：任务3已取消，行业系数合并到职业分类表中

#### ❌ 任务39：创建佣金系数管理页面（已取消）
- **取消原因**：任务4已取消，佣金系数线下记录

#### ❌ 任务40：创建保期系数管理页面（已取消）
- **取消原因**：任务5已改为方案月保费表，不需要保期系数管理页面

#### ❌ 任务41：创建敏感客户管理页面（暂时取消）
- **取消原因**：任务6已暂时取消，不确定保司给的接口是直接校验还是会传一个人名单给我

---

### 4.2 路由配置

#### ⏳ 任务42：在后台管理系统中添加新页面的路由
- **需要添加的路由**：
  1. `/admin/occupations` - 职业分类管理
  2. `/admin/special-agreements` - 特别约定管理
  3. `/admin/clauses` - 条款管理（新增）⭐
- **不需要新增路由**：
  - 方案固定保费管理：在现有的费率管理页面（`/admin/rates`）中扩展功能
- **执行位置**：`admin/src/App.tsx` 或路由配置文件

---

### 4.3 菜单配置

#### ⏳ 任务43：在后台管理系统中添加新页面的菜单项
- **需要添加的菜单项**：
  1. 职业分类管理
  2. 特别约定管理
  3. 条款管理（新增）⭐
- **不需要新增菜单项**：
  - 方案固定保费管理：在现有的费率管理菜单中扩展功能
- **执行位置**：`admin/src/layouts/AdminLayout.tsx` 或菜单配置文件

---

## 五、数据导入脚本（中优先级）

### 5.1 Excel数据导入

#### ⏳ 任务44：创建职业分类数据导入脚本
- **功能要求**：
  - 读取Excel文件"职业分类表_专属"工作表
  - 解析并导入到 `occupation_categories` 表
  - 处理数据验证和错误
  - 支持增量导入和全量导入
- **执行位置**：新建脚本 `backend/scripts/import-occupations.js`
- **数据来源**：`乐选渠道对接表.xlsx` 工作表7

#### ❌ 任务45：创建行业系数数据导入脚本（已取消）
- **取消原因**：任务3已取消，行业系数合并到职业分类表中

#### ⏳ 任务46：创建特别约定数据导入脚本
- **功能要求**：
  - 读取Excel文件"特别约定"工作表
  - 解析并导入到 `special_agreements` 表
  - 处理联动展示标记
- **执行位置**：新建脚本 `backend/scripts/import-special-agreements.js`
- **数据来源**：`乐选渠道对接表.xlsx` 工作表6

---

## 六、类型定义更新（低优先级）

### 6.1 TypeScript类型定义

#### ⏳ 任务47：更新 `types.ts` 中的 `Employee` 类型
- **需要添加的字段**：
  - `jobDescription?: string`
  - `endorsementFlag?: string`
  - `nationality?: string`
  - `salaryCurrency?: string`
  - `monthlySalary?: number`
  - `compensationMonths?: number`
  - `employerUnit?: string`
  - `workLocation?: string`
  - `restaurantBrand?: string` ⭐
  - `hasWorkInjuryInsurance?: boolean`
  - `isHighRiskWork?: boolean` ⭐
  - `remarks?: string`
- **执行位置**：`types.ts`

#### ⏳ 任务48：更新 `types.ts` 中的 `PlanConfig` 类型
- **需要添加的字段**：
  - `policyType?: string` - 投保类型：新保/续保/优续
  - `disabilityRatio?: string` - 伤残比例
  - `isHighRiskWork?: boolean` - 是否涉高
- **执行位置**：`types.ts`

#### ⏳ 任务49：在 `types.ts` 中添加新表的类型定义
- **需要添加的类型**：
  1. `OccupationCategory` - 职业分类
  2. `SpecialAgreement` - 特别约定
  3. `InsuranceClause` - 条款（新增）⭐
  4. `DurationFactor` - 保期系数
  5. `SensitiveCustomer` - 敏感客户
- **执行位置**：`types.ts`

---

## 七、测试数据更新（低优先级）

### 7.1 测试数据脚本更新

#### ⏳ 任务50：更新 `backend/init-test-data.sql` 添加新表测试数据
- **需要添加的测试数据**：
  1. 职业分类表测试数据（至少5-10条，关联利宝保险公司）
  2. 条款表测试数据（至少3-5条，包含主险、附加险、特约，关联利宝保险公司）
  3. 费率表测试数据（方案固定保费：2条，方案一和方案二的月保费和年保费；费率计算：至少5-10条）
  4. 特别约定表测试数据（至少3-5条，关联利宝保险公司、条款和责任）
- **执行位置**：`backend/init-test-data.sql`

---

## 八、文档更新（低优先级）

### 8.1 技术文档

#### ⏳ 任务51：更新数据库设计文档
- **需要更新的内容**：
  - 新增表的说明
  - 扩展字段的说明
  - 表关系图
- **执行位置**：`数据库设计文档.md` 或 `数据库结构图.md`

#### ⏳ 任务52：更新API文档（如果有）
- **需要更新的内容**：
  - 新增字段的说明
  - 参数变更说明
- **执行位置**：相关API文档

---

## 九、验证和测试（所有任务完成后）

### 9.1 数据验证

#### ⏳ 任务53：验证所有配置数据的完整性
- **验证项**：
  1. 职业分类数据完整性（69条，关联利宝保险公司）
  2. 条款数据完整性（主险1条+附加险6条+特约10条，关联利宝保险公司）
  3. 责任数据完整性（主险3条+附加险9条，都关联到条款和利宝保险公司）
  4. 方案配置完整性（方案一、方案二）
  5. 方案固定保费配置完整性（方案一：28元/人/月，方案二：29元/人/月，存储在premium_rates表中）
  6. 特别约定配置完整性（10条，关联利宝保险公司、条款和责任）

#### ⏳ 任务54：验证数据库表结构
- **验证项**：
  1. 所有新表创建成功
  2. 所有字段扩展成功
  3. 索引创建成功
  4. 外键关系正确

### 9.2 功能验证

#### ⏳ 任务55：验证前端页面功能
- **验证项**：
  1. 投保类型选择功能（新保）
  2. 是否涉高选择功能
  3. 人员清单所有新字段显示和输入（基础信息+产品特定必填字段+扩展信息JSON）
  4. 数据提交到后端

#### ⏳ 任务56：验证后台管理页面功能
- **验证项**：
  1. 所有新建管理页面可以正常访问
  2. 列表展示正常
  3. 新增、编辑、删除功能正常
  4. 数据导入功能正常

---

## 📊 任务统计

- **总任务数**：56（其中已取消/暂时不做：任务3、4、6、9、18、19、20、28、38、39、40、41、45）
- **高优先级**：26个（数据库表结构 + 数据配置）
- **中优先级**：20个（前端页面 + 后台管理 + 数据导入）
- **低优先级**：10个（类型定义 + 测试数据 + 文档）
- **已取消/暂时不做**：13个
  - 任务3：行业系数表（合并到任务1）
  - 任务4：佣金系数表（线下记录）
  - 任务6：敏感客户表（暂时取消，待确认接口方式）
  - 任务9：扩展plan_instance_liabilities表（暂时不做）
  - 任务18、19：行业系数和佣金系数相关（已取消）
  - 任务20：保期系数配置（改为方案固定保费，在premium_rates表中）
  - 任务28：伤残比例选择（暂时不做）
  - 任务38、39：行业系数和佣金系数管理页面（已取消）
  - 任务40：保期系数管理页面（已取消）
  - 任务41：敏感客户管理页面（暂时取消）
  - 任务45：行业系数导入脚本（已取消）

---

## 🔄 工作流程建议

1. **第一阶段**：完成数据库表结构任务
   - 任务1：职业分类表（增加company_id，合并行业系数）
   - 任务2：特别约定表（增加company_id、clause_id，关联liability_id，支持只关联条款）
   - 任务5：扩展premium_rates费率表（增加plan_id、premium_type、monthly_premium、annual_premium字段，支持方案固定保费）
   - 任务7：扩展company_liabilities表（增加is_additional和clause_id字段）
   - 任务7-1：扩展insured_persons表（基础信息+产品特定必填字段+扩展信息JSON）
   - 任务8：扩展applications表（增加policy_type和is_high_risk_work字段）
   - 任务12：创建条款表（新增，详细设计见任务12）

2. **第二阶段**：完成所有数据配置任务（任务10-26）
   - 任务10-11：配置责任（关联条款和保司，标识是否附加险）
   - 任务12：配置条款和特约
   - 任务13-16：配置方案和方案责任
   - 任务17：导入职业分类数据（包含行业系数）
   - 任务20：配置方案固定保费（在premium_rates表中）
   - 任务21：配置特别约定（关联条款和责任）
   - 其他配置任务...

3. **第三阶段**：完成前端页面修改（任务27-35）
   - 任务27：投保类型选择（只支持新保）
   - 任务29：是否涉高选择
   - 任务30-32：人员清单字段（基础信息+产品特定必填+扩展信息JSON）
   - 任务34-35：方案选择组件修改

4. **第四阶段**：完成后台管理页面（任务36-43）
   - 任务36：职业分类管理页面
   - 任务37：特别约定管理页面
   - 任务37-1：条款管理页面（新增）
   - 任务37-2：扩展费率管理页面（支持方案固定保费配置）
   - 任务42-43：路由和菜单配置

5. **第五阶段**：完成数据导入脚本（任务44、46）

6. **第六阶段**：完成类型定义和文档更新（任务47-52）

7. **第七阶段**：验证和测试（任务53-56）

---

**文档创建时间**：2025-12-10
**最后更新**：待开始执行
