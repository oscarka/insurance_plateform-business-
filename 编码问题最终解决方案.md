# ç¼–ç é—®é¢˜æœ€ç»ˆè§£å†³æ–¹æ¡ˆ

## ä¸€ã€é—®é¢˜æ€»ç»“

### æ ¹æœ¬åŸå› 
å³ä½¿MySQLæœåŠ¡å™¨ã€æ•°æ®åº“ã€è¡¨éƒ½é…ç½®äº†`utf8mb4`ï¼Œä½†åœ¨**æ‰§è¡ŒSQLè„šæœ¬æ’å…¥æ•°æ®æ—¶**ï¼Œå¦‚æœè¿æ¥å­—ç¬¦é›†ä¸æ˜¯`utf8mb4`ï¼Œæ•°æ®ä¼šè¢«é”™è¯¯ç¼–ç å­˜å‚¨ã€‚

### è¡¨ç°
- `status`å­—æ®µçš„HEXå€¼ï¼š`C3A5C290C2AFC3A7E2809DC2A8`ï¼ˆé”™è¯¯ï¼‰
- æ­£ç¡®çš„HEXå€¼åº”è¯¥æ˜¯ï¼š`E590AFE794A8`ï¼ˆ"å¯ç”¨"çš„UTF-8ç¼–ç ï¼‰

---

## äºŒã€è§£å†³æ–¹æ¡ˆ

### æ–¹æ¡ˆ1ï¼šåœ¨SQLè„šæœ¬å¼€å¤´è®¾ç½®å­—ç¬¦é›† âœ…

**æ–‡ä»¶**ï¼š`backend/init-test-data.sql`

åœ¨è„šæœ¬å¼€å¤´æ·»åŠ ï¼š
```sql
SET NAMES utf8mb4 COLLATE utf8mb4_unicode_ci;
SET CHARACTER SET utf8mb4;
SET character_set_connection = utf8mb4;
SET character_set_client = utf8mb4;
SET character_set_results = utf8mb4;
```

### æ–¹æ¡ˆ2ï¼šæ‰§è¡ŒSQLæ—¶æŒ‡å®šå­—ç¬¦é›† âœ…

```bash
docker exec -i mysql-insurance mysql -uroot -p123456 \
  --default-character-set=utf8mb4 \
  insurance_platform < backend/init-test-data.sql
```

### æ–¹æ¡ˆ3ï¼šç›´æ¥æ›´æ–°é”™è¯¯æ•°æ® âœ…

å¦‚æœæ•°æ®å·²ç»é”™è¯¯æ’å…¥ï¼Œå¯ä»¥ç›´æ¥æ›´æ–°ï¼š
```sql
SET NAMES utf8mb4;
UPDATE insurance_products SET status = 'å¯ç”¨' WHERE product_id = 1;
UPDATE insurance_companies SET status = 'å¯ç”¨' WHERE company_code = 'LIBO';
```

---

## ä¸‰ã€å®Œæ•´çš„æœ€ä½³å®è·µ

### 1. Docker MySQLå®¹å™¨é…ç½® âœ…
```bash
docker run -d \
  --name mysql-insurance \
  -e MYSQL_CHARSET=utf8mb4 \
  -e MYSQL_COLLATION=utf8mb4_unicode_ci \
  mysql:8.0 \
  --character-set-server=utf8mb4 \
  --collation-server=utf8mb4_unicode_ci
```

### 2. SQLè„šæœ¬é…ç½® âœ…
åœ¨SQLè„šæœ¬å¼€å¤´è®¾ç½®å­—ç¬¦é›†ï¼š
```sql
SET NAMES utf8mb4 COLLATE utf8mb4_unicode_ci;
```

### 3. æ‰§è¡ŒSQLæ—¶æŒ‡å®šå­—ç¬¦é›† âœ…
```bash
mysql --default-character-set=utf8mb4 < script.sql
```

### 4. è¿æ¥æ± é…ç½® âœ…
```javascript
// backend/config/database.js
charset: 'utf8mb4',
pool.on('connection', async (connection) => {
  await connection.query('SET NAMES utf8mb4 COLLATE utf8mb4_unicode_ci');
  // ... å…¶ä»–è®¾ç½®
});
```

### 5. HTTPå“åº”å¤´ âœ…
```javascript
res.setHeader('Content-Type', 'application/json; charset=utf-8');
```

---

## å››ã€éªŒè¯

### æ£€æŸ¥æ•°æ®ç¼–ç 
```sql
SELECT product_id, status, HEX(status) 
FROM insurance_products;
```

æ­£ç¡®çš„HEXå€¼ï¼š`E590AFE794A8`ï¼ˆ"å¯ç”¨"ï¼‰

### æµ‹è¯•API
```bash
curl http://localhost:8888/api/products
```

åº”è¯¥è¿”å›æ­£ç¡®çš„UTF-8å­—ç¬¦ã€‚

---

## äº”ã€å·²ä¿®å¤çš„æ–‡ä»¶

1. âœ… `backend/config/database.js` - è¿æ¥æ± å­—ç¬¦é›†é…ç½®
2. âœ… `backend/init-test-data.sql` - SQLè„šæœ¬å­—ç¬¦é›†è®¾ç½®
3. âœ… `ä½¿ç”¨Dockerå¯åŠ¨æ•°æ®åº“.sh` - Dockerå¯åŠ¨è„šæœ¬ï¼ˆå¸¦å­—ç¬¦é›†å‚æ•°ï¼‰

---

**ç°åœ¨æ•°æ®åº”è¯¥æ­£ç¡®äº†ï¼è¯·åˆ·æ–°å‰ç«¯é¡µé¢æµ‹è¯•ã€‚** ğŸ‰

