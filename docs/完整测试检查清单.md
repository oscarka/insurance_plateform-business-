# 完整测试检查清单

## ✅ 已完成的修复

### 1. 接口统一 ✅
- ✅ 所有接口响应格式统一：`{ success: true, data: [...], count: ... }`
- ✅ 前端自动提取 `data` 字段
- ✅ 参数清理：过滤 `undefined` 和空字符串

### 2. 接口对应 ✅
- ✅ `getProducts()` → `GET /api/products`
- ✅ `getPlans(productId)` → `GET /api/products/:id/plans`
- ✅ `getPlanLiabilities(planId)` → `GET /api/plans/:id/liabilities`
- ✅ `calculatePremium(params)` → `POST /api/premium/calculate`
- ✅ `createApplication(data)` → `POST /api/applications`
- ✅ `getInsuranceCompanies()` → `GET /api/insurance-companies`

### 3. 数据清理 ✅
- ✅ 清理了重复和乱码的方案数据
- ✅ 只保留正确的2条方案数据

### 4. 字符集 ✅
- ✅ 所有接口使用UTF-8编码
- ✅ 数据库连接字符集正确设置

---

## 📋 测试步骤

### 步骤1：启动服务
```bash
# 终端1：启动后端
cd backend && node server.js

# 终端2：启动前端
cd .. && npm run dev
```

### 步骤2：测试前端流程

1. **打开前端页面**
   - 访问：http://localhost:5173
   - 进入"选择投保方案"页面

2. **选择产品**
   - 应该看到产品下拉框
   - 选择"雇主责任险A (利宝保险)"
   - ✅ 验证：产品列表正常显示

3. **选择方案**
   - 选择产品后，应该显示方案列表
   - 应该看到"方案一"和"方案二"
   - ✅ 验证：方案列表正常显示

4. **选择责任**
   - 选择方案后，应该显示责任配置
   - 应该看到保额选项（如：10万、30万等）
   - ✅ 验证：责任配置正常显示

5. **填写信息**
   - 填写投保企业信息
   - 选择职业类别、保障时间
   - 选择保额
   - 填写投保人数
   - ✅ 验证：表单正常填写

6. **计算保费**
   - 填写完信息后，应该自动计算保费
   - 或者点击"计算保费"按钮
   - ✅ 验证：保费计算正常

7. **提交投保单**
   - 点击"下一步"
   - 确认信息
   - 提交投保单
   - ✅ 验证：投保单创建成功

---

## 🔍 检查点

### 前端检查
- [ ] 产品列表正常显示
- [ ] 方案列表正常显示
- [ ] 责任配置正常显示
- [ ] 保费计算正常
- [ ] 表单提交正常
- [ ] 没有乱码
- [ ] 控制台没有错误

### 后端检查
- [ ] 所有接口返回200状态码
- [ ] 响应格式正确
- [ ] 数据编码正确（UTF-8）
- [ ] 日志正常输出

### 数据库检查
- [ ] 数据存储正确
- [ ] 字符集配置正确
- [ ] 没有重复数据

---

## 🐛 常见问题

### 问题1：产品列表为空
**原因**：参数传递了 `company_code=undefined`
**解决**：已修复，前端会自动过滤

### 问题2：方案列表为空
**原因**：产品ID不正确或没有方案
**解决**：检查产品ID，确保有方案数据

### 问题3：责任配置为空
**原因**：方案ID不正确或没有责任配置
**解决**：检查方案ID，确保有责任配置数据

### 问题4：乱码
**原因**：字符集配置不正确
**解决**：已修复，所有接口使用UTF-8

---

## 📝 测试日志

### 后端日志
```bash
tail -f /tmp/backend.log
```

### 前端控制台
打开浏览器开发者工具，查看Console标签

---

**所有接口已复查完成，可以开始完整测试了！** 🎉

