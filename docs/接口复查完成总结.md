# æ¥å£å¤æŸ¥å®Œæˆæ€»ç»“

## ä¸€ã€å·²å¤æŸ¥å’Œä¿®å¤çš„æ¥å£

### 1. äº§å“ç›¸å…³æ¥å£ âœ…

#### GET /api/products
- **çŠ¶æ€**ï¼šâœ… æ­£å¸¸
- **å‚æ•°å¤„ç†**ï¼šâœ… å·²ä¿®å¤ï¼ˆè¿‡æ»¤undefinedï¼‰
- **å“åº”æ ¼å¼**ï¼šâœ… ç»Ÿä¸€æ ¼å¼
- **å­—ç¬¦é›†**ï¼šâœ… UTF-8

#### GET /api/products/:id
- **çŠ¶æ€**ï¼šâœ… æ­£å¸¸
- **å“åº”æ ¼å¼**ï¼šâœ… ç»Ÿä¸€æ ¼å¼

#### GET /api/products/:id/plans â­
- **çŠ¶æ€**ï¼šâœ… å·²æ–°å¢
- **åŠŸèƒ½**ï¼šè·å–äº§å“ä¸‹çš„æ–¹æ¡ˆåˆ—è¡¨
- **å“åº”æ ¼å¼**ï¼šâœ… ç»Ÿä¸€æ ¼å¼

### 2. æ–¹æ¡ˆç›¸å…³æ¥å£ âœ…

#### GET /api/plans/:id
- **çŠ¶æ€**ï¼šâœ… æ­£å¸¸
- **å“åº”æ ¼å¼**ï¼šâœ… ç»Ÿä¸€æ ¼å¼

#### GET /api/plans/:id/liabilities
- **çŠ¶æ€**ï¼šâœ… æ­£å¸¸
- **å“åº”æ ¼å¼**ï¼šâœ… ç»Ÿä¸€æ ¼å¼

### 3. ä¿è´¹è®¡ç®—æ¥å£ âœ…

#### POST /api/premium/calculate
- **çŠ¶æ€**ï¼šâœ… æ­£å¸¸
- **å“åº”æ ¼å¼**ï¼šâœ… ç»Ÿä¸€æ ¼å¼ï¼ˆè¿”å›dataå¯¹è±¡ï¼‰

#### GET /api/premium/rates
- **çŠ¶æ€**ï¼šâœ… æ­£å¸¸
- **å“åº”æ ¼å¼**ï¼šâœ… ç»Ÿä¸€æ ¼å¼

### 4. æŠ•ä¿å•æ¥å£ âœ…

#### POST /api/applications
- **çŠ¶æ€**ï¼šâœ… æ­£å¸¸
- **å“åº”æ ¼å¼**ï¼šâœ… ç»Ÿä¸€æ ¼å¼

#### GET /api/applications/:id
- **çŠ¶æ€**ï¼šâœ… æ­£å¸¸
- **å“åº”æ ¼å¼**ï¼šâœ… ç»Ÿä¸€æ ¼å¼

#### POST /api/applications/:id/underwriting
- **çŠ¶æ€**ï¼šâœ… æ­£å¸¸
- **å“åº”æ ¼å¼**ï¼šâœ… ç»Ÿä¸€æ ¼å¼

### 5. ä¿å¸æ¥å£ âœ…

#### GET /api/insurance-companies
- **çŠ¶æ€**ï¼šâœ… æ­£å¸¸
- **å“åº”æ ¼å¼**ï¼šâœ… ç»Ÿä¸€æ ¼å¼

---

## äºŒã€ç»Ÿä¸€çš„å“åº”æ ¼å¼å¤„ç†

### å‰ç«¯ request å‡½æ•° âœ…

**ä¿®æ”¹**ï¼šç»Ÿä¸€å¤„ç†æ‰€æœ‰æ¥å£çš„å“åº”æ ¼å¼
```typescript
// å¦‚æœè¿”å›çš„æ˜¯{success, data, count}æ ¼å¼ï¼Œè‡ªåŠ¨æå–dataå­—æ®µ
if (data && typeof data === 'object' && 'success' in data && 'data' in data) {
  if (Array.isArray(data.data)) {
    return data.data;  // è¿”å›æ•°ç»„
  }
  return data.data;    // è¿”å›å¯¹è±¡
}
```

**æ•ˆæœ**ï¼š
- æ‰€æœ‰æ¥å£è°ƒç”¨éƒ½ä¸éœ€è¦æ‰‹åŠ¨æå– `data` å­—æ®µ
- å‰ç«¯ä»£ç æ›´ç®€æ´
- å“åº”æ ¼å¼ç»Ÿä¸€

### åç«¯å“åº”æ ¼å¼ âœ…

æ‰€æœ‰æ¥å£ç»Ÿä¸€è¿”å›ï¼š
```json
{
  "success": true,
  "data": [...],  // æˆ– {...}
  "count": ...     // å¯é€‰ï¼Œæ•°ç»„æ—¶æä¾›
}
```

---

## ä¸‰ã€å·²ä¿®å¤çš„é—®é¢˜

1. âœ… **å‚æ•°æ¸…ç†**ï¼šè¿‡æ»¤æ‰ `undefined` å’Œç©ºå­—ç¬¦ä¸²å‚æ•°
2. âœ… **å“åº”æ ¼å¼ç»Ÿä¸€**ï¼šå‰ç«¯è‡ªåŠ¨æå– `data` å­—æ®µ
3. âœ… **æ–°å¢æ¥å£**ï¼š`GET /api/products/:id/plans`
4. âœ… **å­—ç¬¦é›†é…ç½®**ï¼šæ‰€æœ‰æ¥å£ä½¿ç”¨æ­£ç¡®çš„UTF-8ç¼–ç 
5. âœ… **æ—¥å¿—å¢å¼º**ï¼šæ‰€æœ‰æ¥å£éƒ½æœ‰è¯¦ç»†çš„æ—¥å¿—è®°å½•

---

## å››ã€æµ‹è¯•ç»“æœ

### æ¥å£æµ‹è¯• âœ…
```
âœ… 1. äº§å“åˆ—è¡¨: 1 æ¡
âœ… 2. äº§å“æ–¹æ¡ˆåˆ—è¡¨: 2 æ¡
âœ… 3. æ–¹æ¡ˆè´£ä»»é…ç½®: 3 æ¡
âœ… 4. ä¿å¸åˆ—è¡¨: 1 æ¡
```

### å‰ç«¯è°ƒç”¨ âœ…
- `getProducts()` - è¿”å›æ•°ç»„
- `getPlans(productId)` - è¿”å›æ•°ç»„
- `getPlanLiabilities(planId)` - è¿”å›æ•°ç»„
- `calculatePremium(params)` - è¿”å›å¯¹è±¡ï¼ˆåŒ…å«premium_per_personç­‰ï¼‰

---

## äº”ã€å®Œæ•´æµ‹è¯•æµç¨‹

### æ­¥éª¤1ï¼šå¯åŠ¨æœåŠ¡
```bash
# åç«¯ï¼ˆç»ˆç«¯1ï¼‰
cd backend && node server.js

# å‰ç«¯ï¼ˆç»ˆç«¯2ï¼‰
cd .. && npm run dev
```

### æ­¥éª¤2ï¼šæµ‹è¯•å‰ç«¯æµç¨‹
1. æ‰“å¼€ï¼šhttp://localhost:5173
2. è¿›å…¥"é€‰æ‹©æŠ•ä¿æ–¹æ¡ˆ"é¡µé¢
3. **é€‰æ‹©äº§å“** â†’ åº”è¯¥æ˜¾ç¤ºäº§å“åˆ—è¡¨
4. **é€‰æ‹©æ–¹æ¡ˆ** â†’ åº”è¯¥æ˜¾ç¤ºæ–¹æ¡ˆåˆ—è¡¨
5. **é€‰æ‹©è´£ä»»** â†’ åº”è¯¥æ˜¾ç¤ºè´£ä»»é…ç½®å’Œä¿é¢é€‰é¡¹
6. **å¡«å†™ä¿¡æ¯** â†’ è®¡ç®—ä¿è´¹
7. **æäº¤æŠ•ä¿å•** â†’ åˆ›å»ºæŠ•ä¿å•

### æ­¥éª¤3ï¼šæŸ¥çœ‹æ—¥å¿—
- **åç«¯æ—¥å¿—**ï¼š`tail -f /tmp/backend.log`
- **å‰ç«¯æ§åˆ¶å°**ï¼šæµè§ˆå™¨å¼€å‘è€…å·¥å…·

---

## å…­ã€æ¥å£å¯¹åº”å…³ç³»

| å‰ç«¯è°ƒç”¨ | åç«¯æ¥å£ | çŠ¶æ€ |
|---------|---------|------|
| `getProducts()` | `GET /api/products` | âœ… |
| `getPlans(productId)` | `GET /api/products/:id/plans` | âœ… |
| `getPlanLiabilities(planId)` | `GET /api/plans/:id/liabilities` | âœ… |
| `calculatePremium(params)` | `POST /api/premium/calculate` | âœ… |
| `createApplication(data)` | `POST /api/applications` | âœ… |
| `getInsuranceCompanies()` | `GET /api/insurance-companies` | âœ… |

---

**æ‰€æœ‰æ¥å£å·²å¤æŸ¥å®Œæˆï¼Œå‰åç«¯å·²å¯¹åº”å¥½ï¼Œå¯ä»¥å®Œæ•´æµ‹è¯•äº†ï¼** ğŸ‰

